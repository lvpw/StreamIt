splitjoin AutoCor(int N, int NLAGS) {
    split Duplicate();
    for (int lag=0; lag<NLAGS; lag++)
	add float->float filter {
	work push N pop N {
	    float sum = 0;
	    for (int i=0; i<N-lag; i++) {
		sum += peek(0) * peek(lag);
		pop();
	    }
	    for (int i=0; i<lag; i++) {
		pop();
	    }
	    push(sum);
	}
    };
    join RoundRobin();
}


