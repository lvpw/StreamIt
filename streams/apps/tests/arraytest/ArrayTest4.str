/**

This just tests 3-D arrays as fields.  Inspired by MPEG error.

% strc -library ArrayTest4.str -i 2
0
1
2
3
4
5
6
7
8
9
10
11

**/

void->void pipeline ArrayTest4 {
    add Source();
    add Test();
    add Printer();
}

int->int stateful filter Test {
    int[1][2][3] array;
    
    work pop 1*2*3 push 1*2*3 {
	for (int i=0; i<1; i++) {
	    for (int j=0; j<2; j++) {
		for (int k=0; k<3; k++) {
		    array[i][j][k] = pop();
		}
	    }
	}

	for (int i=0; i<1; i++) {
	    for (int j=0; j<2; j++) {
		for (int k=0; k<3; k++) {
		    push(array[i][j][k]);
		}
	    }
	}

    }
}

void->int stateful filter Source {
    int i = 0;
    work push 1 { push(i++); }
}

int->void filter Printer {
    work pop 1 { println(pop()); }
}

