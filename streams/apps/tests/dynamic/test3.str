
void->int stateful filter Source {
  int count;
  init {
     count = 0;
  }
  work push 1 {
    push(count++);
  }
}

 int->int filter F1 {
   work pop 1 push 1 {
     push(pop());
   }
 }


 int->int filter F2 {
   work pop 1 push 1 {
     push(pop());
   }
 }


int->void filter Sink {
   work pop 1 {
     println(pop());
   }
}

void->void pipeline test3 {
    add Source();
    add int->int splitjoin {
        split roundrobin();
        add F1();
        add F2();
        join roundrobin();
    }
    add Sink();
}

