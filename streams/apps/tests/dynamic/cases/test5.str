
void->float filter A {
   work push 1 {
     int c;
     for (int i = 0; i < 100000; i++) {
       c += i;
     }   
     push(c);
   }
}

float->float stateful filter B {
  float count;
  init {
     count = 0.0;
  }
  work pop 1 push 1 {
   count = 0.1;
   float x = pop();
   for (int i = 0; i < 100000; i++) {
     count += i - x;
   }

   push(count++);      
 }
}

float->float stateful filter C {
  float count;
  init {
     count = 0;
  }
  work pop 1 push 1 {
    pop();
    push(count++);      
 }
}

float->void stateful filter D {
  init {
     float y = 1.0;
  }
   work pop 1 {
     do_work(1.0);
     println(pop());
   }
   
   float do_work(float x) {
     y = 1.0;
     for (int i = 0; i < 100000; i++) {
       y += i - x;
     }
     return y;
   }

}


void->void pipeline test5 {
    add A();
    add B();
    add C();
    add D();
}

