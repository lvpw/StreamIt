
void->int stateful filter A {
  int count;
  init {
     count = 0;
  }
  work push 1 {
    push(count++);
  }
}

int->int stateful filter B {
  int count;
  init {
     count = 0;
  }
    work pop 1 push * {
      pop();
      int i;     
      int amount = count%10; 
      push(amount);     
      for(i=0; i < amount; i++)
          push(count++);
   
   }
}

int->int stateful filter C {
  int count;
  init {
     count = 0;
  }    
    work pop * push 1 {
      count++;
      push(pop());      
   }
}

int->void filter D {
   work pop 1 {
     int amount = pop() + 1; 
     println(amount);
   }
}

void->void pipeline test6 {
    add A();
    add B();
    add C();
    add D();
}

