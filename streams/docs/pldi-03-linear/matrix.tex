\section{Representing Linear Nodes}
\label{sec:linearrep}

There is no general relationship that must hold between a
filter's input data and its output data. In actual applications, the
output is typically derived from the input, but the relationship is
not always clear since a filter has state and can call external
functions.

However, we note that a large subset of DSP operations produce outputs
that are some affine function of their input, and we call
filters that implement such operations {\it linear}. Examples of such
filters are finite impulse response (FIR) filters, compressors,
expanders and signal processing transforms such as the discrete
Fourier transform (DFT) and discrete cosine transformation (DCT).  Our
formal definition of a linear node is as follows (refer to
Figure~\ref{fig:overview-matrix} for an illustration). 
\vspace{-4pt}
\begin{definition}(Linear node)
A linear node $\lambda$ $=$ $\{A,$ $\vec{b},$ $e,$ $o,$ $u\}$
represents an abstract stream block which performs an affine
transformation $\vec{y} = \vec{x} A + \vec{b}$ from input elements 
$\vec{x}$ to output elements $\vec{y}$. $A$ is an $e \times u$ matrix, $\vec{b}$ is a
$u$-element row vector, and $e$, $o$ and $u$ are the peek, pop and
push rates, respectively. \\ 
~ \vspace{-6pt} \\
A ``firing'' of a linear node $\lambda$ corresponds to the following
series of abstract execution steps.  First, an $e$-element row vector
$\vec{x}$ is constructed with $\vec{x}[i] = \mbox{peek}(e-1-i)$.  The node
computes $\vec{y} = \vec{x} A + \vec{b}$, and then pushes the $u$ elements 
of $\vec{y}$ onto the output tape, starting with $\vec{y}\hspace{1pt}[u-1]$ 
and proceeding through $\vec{y}\hspace{1pt}[0]$.
Finally, $o$ items are popped from the input tape.
\end{definition} \vspace{-2pt}

\begin{figure}[t]
\vspace{-6pt}
\center
\epsfxsize=1.5in
\epsfbox{images/general-picture.eps}
\vspace{-12pt}
\caption{Linear filter as a vector-matrix operation}
\label{fig:overview-matrix}
\vspace{-6pt}
\end{figure}

The intuition of the computation represented by a linear node is
simply that specific columns generate specific outputs and specific
rows correspond to using specific inputs.  The values found in row
$e-1-i$ of $A$ ({\it i.e.} the $i$th row from the bottom) and 
column $u-1-j$ of $A$ ({\it i.e.} the $j$th column from the right) 
represents a term in the formula to compute the $j$th output item using 
the value of peek($i$). The value in column $u-1-j$ of 
$\vec{b}$ is a constant offset added to output $j$.
Figure~\ref{fig:linear-node-example} shows a concrete example
of a work function and its corresponding linear node.

\begin{figure}
\center
\epsfxsize=2.0in
\epsfbox{images/linear-node-example.eps}
\vspace{-12pt}
\caption{Filter-linear node correspondence.}
\label{fig:linear-node-example}
\vspace{-12pt}
\end{figure}
