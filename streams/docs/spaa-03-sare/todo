- change pop to peek in the phased one
- could be a problem to take the product of parameters like I'm doing all over really

